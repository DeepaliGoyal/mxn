<html>
<head>

    <script src="\jquery-1.8.2.min.js" type="text/javascript"></script>
	
	<script type="text/javascript">
	var googlev3_key = 'AIzaSyDW21lnrSsBk4OyHUDmBQ7su9di3yMaO7I';
	var nokia_app_id = 'FbgYuugcrj8Taq6JjmUK';
	var nokia_auth_token = 'Yy2i2n98kaWj69qysOmcYg';
	var microsoftv7_key = 'AlneHdcKOFDot4FjwyuLH8ZSUIz5rv_X22vULKa7H5ia0JnsxiykdO8y-dgLQMU6';
	var provider = 'googlev3';
	var openspace_key = 'CEEFBE51588492CBE0405F0ACA6010B1';
	
	var providerMatch = location.search.match(/provider=([^&]*)/);
	if (providerMatch) {
		provider = providerMatch[1];
	}
	//document.writeln('<script type="text/javascript" src="../source/mxn.js?(' + provider + ',[autoload])"><\/script>');
	var autoload = ',[autoload]'
	document.writeln('<script type="text/javascript" src="../source/mxn.js?(' + provider + autoload +')"><\/script>');
	</script>
	<script type="text/javascript">

	function defaultHandler(name, source, args) {
		console.log(name + ' for ' + args.tileMap.properties.name);
	}

	$(document).ready(function () {

	    var props = {
	        controls: {
	            pan: true,
	            zoom: 'small',
	            overview: 9,
	            scale: true,
	            map_type: true
	        },
	        center: [51.50730, -0.12763],
	        zoom: 10, //Ordnance survey only goes to 10
            enableScrollWheelZoom: true,
            map_type: mxn.Mapstraction.SATELLITE
	    };

	    var mapInit = new mxn.Mapstraction('mapInit', provider, props);
	    var mapSetOptions = new mxn.Mapstraction('mapSetOptions', provider, {
	        center: props.center,
            zoom: props.zoom
	    });
        
	    var mapFunctions = new mxn.Mapstraction('mapFunctions', provider, {
	        center: props.center,
	        zoom: props.zoom
	    });

	    mapInit.load.addHandler(function (sEvtName, oEvtSource, oEvtArgs) {
	        console.log('Map loaded for provider: ' + oEvtSource.api);
	    });
        
	    mapSetOptions.load.addHandler(function (sEvtName, oEvtSource, oEvtArgs) {
	        console.log('Map loaded for provider: ' + oEvtSource.api);

	        setTimeout(function () {
	            mapSetOptions.setOptions(props);
	        }, 1000);
	    });
        
	    mapFunctions.load.addHandler(function (sEvtName, oEvtSource, oEvtArgs) {
	        console.log('Map loaded for provider: ' + oEvtSource.api);

	        setTimeout(function () {
	            mapFunctions.enableScrollWheelZoom();
	            mapFunctions.setMapType(props.map_type);
	            mapFunctions.addScaleControls();
	            mapFunctions.addOverviewControls();
	            mapFunctions.addMapTypeControls();
	            mapFunctions.addPanControls();
	            mapFunctions.addSmallControls();
	        }, 1000);
	    });
	
	});
	</script>
	<style type="text/css">
	.map {
		width: 100%;
		height: 33%;
		position: relative;
	}
	</style>
</head>
<body>
	<div id="mapInit" class="map"></div>
    <div id="mapSetOptions" class="map"></div>
    <div id="mapFunctions" class="map"></div>
</body>
</html>